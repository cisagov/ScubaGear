"Control ID","Requirement","Result","Criticality","Details"
"MS.AAD.1.1v1","Legacy authentication SHALL be blocked.","Pass","Shall","1 conditional access policy(s) found that meet(s) all requirements: MS.AAD.1.1v1 Legacy authentication SHALL be blocked. "
"MS.AAD.2.1v1","Users detected as high risk SHALL be blocked.","Pass","Shall","1 conditional access policy(s) found that meet(s) all requirements: MS.AAD.2.1v1 Users detected as high risk SHALL be blocked. "
"MS.AAD.2.2v1","A notification SHOULD be sent to the administrator when high-risk users are detected.","N/A","Should/Not-Implemented","This product does not currently have the capability to check compliance for this policy. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/aad.md#msaad22v1 for instructions on manual check"
"MS.AAD.2.3v1","Sign-ins detected as high risk SHALL be blocked.","Pass","Shall","1 conditional access policy(s) found that meet(s) all requirements: MS.AAD.2.3v1 Sign-ins detected as high risk SHALL be blocked. "
"MS.AAD.3.1v1","Phishing-resistant MFA SHALL be enforced for all users.","Fail","Shall","0 conditional access policy(s) found that meet(s) all requirements. "
"MS.AAD.3.2v1","If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users.","Pass","Shall","1 conditional access policy(s) found that meet(s) all requirements: MS.AAD.3.2v1 If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users. "
"MS.AAD.3.3v1","If phishing-resistant MFA has not been enforced and Microsoft Authenticator is enabled, it SHALL be configured to show login context information.","Fail","Shall","Requirement not met"
"MS.AAD.3.4v1","The Authentication Methods Manage Migration feature SHALL be set to Migration Complete.","Fail","Shall","Requirement not met"
"MS.AAD.3.5v1","The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled.","N/A","Shall/Not-Implemented","This policy is only applicable if the tenant has their Manage Migration feature set to Migration Complete. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/aad.md#msaad34v1 for more info"
"MS.AAD.3.6v1","Phishing-resistant MFA SHALL be required for highly privileged roles.","Fail","Shall","0 conditional access policy(s) found that meet(s) all requirements. "
"MS.AAD.3.7v1","Managed devices SHOULD be required for authentication.","Warning","Should","0 conditional access policy(s) found that meet(s) all requirements. "
"MS.AAD.3.8v1","Managed Devices SHOULD be required to register MFA.","Warning","Should","0 conditional access policy(s) found that meet(s) all requirements. "
"MS.AAD.4.1v1","Security logs SHALL be sent to the agency's security operations center for monitoring.","N/A","Shall/Not-Implemented","This product does not currently have the capability to check compliance for this policy. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/aad.md#msaad41v1 for instructions on manual check"
"MS.AAD.5.1v1","Only administrators SHALL be allowed to register applications.","Pass","Shall","0 authorization policies found that allow non-admin users to register third-party applications"
"MS.AAD.5.2v1","Only administrators SHALL be allowed to consent to applications.","Fail","Shall","1 authorization policies found that allow non-admin users to consent to third-party applications: authorizationPolicy"
"MS.AAD.5.3v1","An admin consent workflow SHALL be configured for applications.","Fail","Shall","Requirement not met"
"MS.AAD.5.4v1","Group owners SHALL NOT be allowed to consent to applications.","N/A","Shall/Not-Implemented","This configuration setting has been deprecated and we are in the process of removing it from the baseline."
"MS.AAD.6.1v1","User passwords SHALL NOT expire.","Fail","Shall","Requirement not met"
"MS.AAD.7.1v1","A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role.","Pass","Shall","2 global admin(s) found: Jane Doe, John Public"
"MS.AAD.7.2v1","Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator.","Fail","Shall","Requirement not met: Least Privilege Score = 2 (should be 1 or less)"
"MS.AAD.7.3v1","Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers.","Pass","Shall","0 admin(s) that are not cloud-only found"
"MS.AAD.7.4v1","Permanent active role assignments SHALL NOT be allowed for highly privileged roles.","Fail","Shall","6 role(s) that contain users with permanent active assignment: Application Administrator, Exchange Administrator, Global Administrator, Privileged Role Administrator, SharePoint Administrator, User Administrator"
"MS.AAD.7.5v1","Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system.","Fail","Shall","4 role(s) assigned to users outside of PIM: Global Administrator, Privileged Role Administrator, SharePoint Administrator, User Administrator"
"MS.AAD.7.6v1","Activation of the Global Administrator role SHALL require approval.","Fail","Shall","1 role(s) or group(s) allowing activation without approval found: Global Administrator(Directory Role)"
"MS.AAD.7.7v1","Eligible and Active highly privileged role assignments SHALL trigger an alert.","Fail","Shall","6 role(s) or group(s) without notification e-mail configured for role assignments found: Cloud Application Administrator(Directory Role), Exchange Administrator(Directory Role), Global Administrator(Directory Role), Hybrid Identity Administrator(Directory Role), Privileged Role Administrator(Directory Role), SharePoint Administrator(Directory Role)"
"MS.AAD.7.8v1","User activation of the Global Administrator role SHALL trigger an alert.","Pass","Shall","0 role(s) or group(s) without notification e-mail configured for Global Administrator activations found"
"MS.AAD.7.9v1","User activation of other highly privileged roles SHOULD trigger an alert.","Warning","Should","5 role(s) or group(s) without notification e-mail configured for role activations found: Cloud Application Administrator(Directory Role), Exchange Administrator(Directory Role), Hybrid Identity Administrator(Directory Role), Privileged Role Administrator(Directory Role), SharePoint Administrator(Directory Role)"
"MS.AAD.8.1v1","Guest users SHOULD have limited or restricted access to Microsoft Entra ID directory objects.","Pass","Should","Permission level set to ""Limited access"" (authorizationPolicy)"
"MS.AAD.8.2v1","Only users with the Guest Inviter role SHOULD be able to invite guest users.","Pass","Should","Permission level set to ""adminsAndGuestInviters"" (authorizationPolicy)"
"MS.AAD.8.3v1","Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes.","N/A","Should/Not-Implemented","This product does not currently have the capability to check compliance for this policy. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/aad.md#msaad83v1 for instructions on manual check"
"MS.DEFENDER.1.1v1","The standard and strict preset security policies SHALL be enabled.","Pass","Shall","Requirement met"
"MS.DEFENDER.1.2v1","All users SHALL be added to Exchange Online Protection (EOP) in either the standard or strict preset security policy.","Pass","Shall","Requirement met"
"MS.DEFENDER.1.3v1","All users SHALL be added to Defender for Office 365 protection in either the standard or strict preset security policy.","Pass","Shall","Requirement met"
"MS.DEFENDER.1.4v1","Sensitive accounts SHALL be added to Exchange Online Protection in the strict preset security policy.","Fail","Shall","Requirement not met"
"MS.DEFENDER.1.5v1","Sensitive accounts SHALL be added to Defender for Office 365 protection in the strict preset security policy.","Fail","Shall","Requirement not met"
"MS.DEFENDER.2.1v1","User impersonation protection SHOULD be enabled for sensitive accounts in both the standard and strict preset policies.","Pass","Should","Requirement met"
"MS.DEFENDER.2.2v1","Domain impersonation protection SHOULD be enabled for domains owned by the agency in both the standard and strict preset policies.","Warning","Should","Not all agency domains are included for targeted protection in Strict or Standard policy."
"MS.DEFENDER.2.3v1","Domain impersonation protection SHOULD be added for important partners in both the standard and strict preset policies.","Warning","Should","Not all partner domains are included for targeted protection in Strict or Standard policy."
"MS.DEFENDER.3.1v1","Safe attachments SHOULD be enabled for SharePoint, OneDrive, and Microsoft Teams.","Pass","Should","Requirement met"
"MS.DEFENDER.4.1v2","A custom policy SHALL be configured to protect PII and sensitive information, as defined by the agency, blocking at a minimum: credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN).","Pass","Shall","Requirement met"
"MS.DEFENDER.4.2v1","The custom policy SHOULD be applied to Exchange, OneDrive, SharePoint, Teams chat, and Devices.","Warning","Should","DLP custom policy applied to the following locations: Exchange, OneDrive, SharePoint, Teams. Custom policy protecting sensitive info types NOT applied to: Devices. Devices location requires DLP for Endpoint licensing and at least one registered device. For full policy details, see the ActualValue field in the results file: ./TestResults.json"
"MS.DEFENDER.4.3v1","The action for the custom policy SHOULD be set to block sharing sensitive information with everyone.","Pass","Should","Requirement met"
"MS.DEFENDER.4.4v1","Notifications to inform users and help educate them on the proper use of sensitive information SHOULD be enabled in the custom policy.","Pass","Should","Requirement met"
"MS.DEFENDER.4.5v1","A list of apps that are restricted from accessing files protected by DLP policy SHOULD be defined.","N/A","Should/Not-Implemented","This product does not currently have the capability to check compliance for this policy. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/defender.md#msdefender45v1 for instructions on manual check"
"MS.DEFENDER.4.6v1","The custom policy SHOULD include an action to block access to sensitive information by restricted apps and unwanted Bluetooth applications.","N/A","Should/Not-Implemented","This product does not currently have the capability to check compliance for this policy. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/defender.md#msdefender46v1 for instructions on manual check"
"MS.DEFENDER.5.1v1","At a minimum, the alerts required by the CISA M365 Secure Configuration Baseline for Exchange Online SHALL be enabled.","Pass","Shall","Requirement met"
"MS.DEFENDER.5.2v1","The alerts SHOULD be sent to a monitored address or incorporated into a Security Information and Event Management (SIEM).","N/A","Should/Not-Implemented","This product does not currently have the capability to check compliance for this policy. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/defender.md#msdefender52v1 for instructions on manual check"
"MS.DEFENDER.6.1v1","Microsoft Purview Audit (Standard) logging SHALL be enabled.","Pass","Shall","Requirement met"
"MS.DEFENDER.6.2v1","Microsoft Purview Audit (Premium) logging SHALL be enabled for ALL users.","Fail","Shall","Requirement not met. 84 tenant users without M365 Advanced Auditing feature assigned. To review and assign users the Microsoft 365 Advanced Auditing feature, see Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/defender.md#msdefender62v1. To get a list of all users without the license feature run the following: Get-MgBetaUser -Filter ""not assignedPlans/any(a:a/servicePlanId eq 2f442157-a11c-46b9-ae5b-6e39ff4e5849 and a/capabilityStatus eq 'Enabled')"" -ConsistencyLevel eventual -Count UserCount -All | Select-Object DisplayName,UserPrincipalName"
"MS.DEFENDER.6.3v1","Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31.","N/A","Shall/Not-Implemented","This product does not currently have the capability to check compliance for this policy. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/defender.md#msdefender63v1 for instructions on manual check"
"MS.EXO.1.1v1","Automatic forwarding to external domains SHALL be disabled.","Pass","Shall","Requirement met"
"MS.EXO.2.2v2","An SPF policy SHALL be published for each domain that fails all non-approved senders.","Pass","Shall","Requirement met"
"MS.EXO.3.1v1","DKIM SHOULD be enabled for all domains.","Warning","Should","1 agency domain(s) found in violation: tqhjy.mail.onmicrosoft.com"
"MS.EXO.4.1v1","A DMARC policy SHALL be published for every second-level domain.","Fail","Shall","2 agency domain(s) found in violation: tqhjy.mail.onmicrosoft.com, tqhjy.onmicrosoft.com"
"MS.EXO.4.2v1","The DMARC message rejection option SHALL be p=reject.","Fail","Shall","2 agency domain(s) found in violation: tqhjy.mail.onmicrosoft.com, tqhjy.onmicrosoft.com"
"MS.EXO.4.3v1","The DMARC point of contact for aggregate reports SHALL include `reports@dmarc.cyber.dhs.gov`.","Fail","Shall","2 agency domain(s) found in violation: tqhjy.mail.onmicrosoft.com, tqhjy.onmicrosoft.com"
"MS.EXO.4.4v1","An agency point of contact SHOULD be included for aggregate and failure reports.","Warning","Should","2 agency domain(s) found in violation: tqhjy.mail.onmicrosoft.com, tqhjy.onmicrosoft.com"
"MS.EXO.5.1v1","SMTP AUTH SHALL be disabled.","Pass","Shall","Requirement met"
"MS.EXO.6.1v1","Contact folders SHALL NOT be shared with all domains.","Pass","Shall","Requirement met"
"MS.EXO.6.2v1","Calendar details SHALL NOT be shared with all domains.","Pass","Shall","Requirement met"
"MS.EXO.7.1v1","External sender warnings SHALL be implemented.","Pass","Shall","Requirement met"
"MS.EXO.8.1v2","A DLP solution SHALL be used.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo81v2 for instructions on a manual check."
"MS.EXO.8.2v2","The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo82v2 for instructions on a manual check."
"MS.EXO.8.3v1","The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo83v1 for instructions on a manual check."
"MS.EXO.8.4v1","At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo84v1 for instructions on a manual check."
"MS.EXO.9.1v2","Emails SHALL be filtered by attachment file types.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo91v2 for instructions on a manual check."
"MS.EXO.9.2v1","The attachment filter SHOULD attempt to determine the true file type and assess the file extension.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo92v1 for instructions on a manual check."
"MS.EXO.9.3v2","Disallowed file types SHALL be determined and enforced.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo93v2 for instructions on a manual check."
"MS.EXO.9.4v1","Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender's Common Attachment Filter.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo94v1 for instructions on a manual check."
"MS.EXO.9.5v1","At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe).","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo95v1 for instructions on a manual check."
"MS.EXO.10.1v1","Emails SHALL be scanned for malware.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo101v1 for instructions on a manual check."
"MS.EXO.10.2v1","Emails identified as containing malware SHALL be quarantined or dropped.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo102v1 for instructions on a manual check."
"MS.EXO.10.3v1","Email scanning SHALL be capable of reviewing emails after delivery.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo103v1 for instructions on a manual check."
"MS.EXO.11.1v1","Impersonation protection checks SHOULD be used.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo111v1 for instructions on a manual check."
"MS.EXO.11.2v1","User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo112v1 for instructions on a manual check."
"MS.EXO.11.3v1","The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo113v1 for instructions on a manual check."
"MS.EXO.12.1v1","IP allow lists SHOULD NOT be created.","Pass","Should","Requirement met"
"MS.EXO.12.2v1","Safe lists SHOULD NOT be enabled.","Pass","Should","Requirement met"
"MS.EXO.13.1v1","Mailbox auditing SHALL be enabled.","Pass","Shall","Requirement met"
"MS.EXO.14.1v2","A spam filter SHALL be enabled.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo141v2 for instructions on a manual check."
"MS.EXO.14.2v1","Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo142v1 for instructions on a manual check."
"MS.EXO.14.3v1","Allowed domains SHALL NOT be added to inbound anti-spam protection policies.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo143v1 for instructions on a manual check."
"MS.EXO.14.4v1","If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo144v1 for instructions on a manual check."
"MS.EXO.15.1v1","URL comparison with a block-list SHOULD be enabled.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo151v1 for instructions on a manual check."
"MS.EXO.15.2v1","Direct download links SHOULD be scanned for malware.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo152v1 for instructions on a manual check."
"MS.EXO.15.3v1","User click tracking SHOULD be enabled.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo153v1 for instructions on a manual check."
"MS.EXO.16.1v1","At a minimum, the following alerts SHALL be enabled: a. Suspicious email sending patterns detected. b. Suspicious Connector Activity. c. Suspicious Email Forwarding Activity. d. Messages have been delayed. e. Tenant restricted from sending unprovisioned email. f. Tenant restricted from sending email. g. A potentially malicious URL click was detected. ","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo161v1 for instructions on a manual check."
"MS.EXO.16.2v1","The alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo162v1 for instructions on a manual check."
"MS.EXO.17.1v1","Microsoft Purview Audit (Standard) logging SHALL be enabled.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo171v1 for instructions on a manual check."
"MS.EXO.17.2v1","Microsoft Purview Audit (Premium) logging SHALL be enabled.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo172v1 for instructions on a manual check."
"MS.EXO.17.3v1","Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C).","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/exo.md#msexo173v1 for instructions on a manual check."
"MS.POWERPLATFORM.1.1v1","The ability to create production and sandbox environments SHALL be restricted to admins.","Pass","Shall","Requirement met"
"MS.POWERPLATFORM.1.2v1","The ability to create trial environments SHALL be restricted to admins.","Pass","Shall","Requirement met"
"MS.POWERPLATFORM.2.1v1","A DLP policy SHALL be created to restrict connector access in the default Power Platform environment.","Pass","Shall","Requirement met"
"MS.POWERPLATFORM.2.2v1","Non-default environments SHOULD have at least one DLP policy affecting them.","Warning","Should","1 Subsequent environments without DLP policies: 2c9cc86c-7a06-4162-adc0-be71f93abb4d"
"MS.POWERPLATFORM.3.1v1","Power Platform tenant isolation SHALL be enabled.","Pass","Shall","Requirement met"
"MS.POWERPLATFORM.3.2v1","An inbound/outbound connection allowlist SHOULD be configured.","N/A","Should/Not-Implemented","This product does not currently have the capability to check compliance for this policy. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/powerplatform.md#mspowerplatform32v1 for instructions on manual check"
"MS.POWERPLATFORM.4.1v1","Content Security Policy (CSP) SHALL be enforced for model-driven and canvas Power Apps.","N/A","Shall/Not-Implemented","This product does not currently have the capability to check compliance for this policy. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/powerplatform.md#mspowerplatform41v1 for instructions on manual check"
"MS.POWERPLATFORM.5.1v1","The ability to create Power Pages sites SHOULD be restricted to admins.","Pass","Should","Requirement met"
"MS.SHAREPOINT.1.1v1","External sharing for SharePoint SHALL be limited to Existing guests or Only people in your organization.","Pass","Shall","Requirement met"
"MS.SHAREPOINT.1.2v1","External sharing for OneDrive SHALL be limited to Existing guests or Only people in your organization.","Pass","Shall","Requirement met"
"MS.SHAREPOINT.1.3v1","External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs.","N/A","Shall/Not-Implemented","This policy is only applicable if the external sharing slider on the admin page is not set to Only People In Your Organization. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint13v1 for more info"
"MS.SHAREPOINT.1.4v1","Guest access SHALL be limited to the email the invitation was sent to.","N/A","Shall/Not-Implemented","This configuration setting has been deprecated and we are in the process of removing it from the baseline."
"MS.SHAREPOINT.2.1v1","File and folder default sharing scope SHALL be set to Specific people (only the people the user specifies).","Pass","Shall","Requirement met"
"MS.SHAREPOINT.2.2v1","File and folder default sharing permissions SHALL be set to View.","Pass","Shall","Requirement met"
"MS.SHAREPOINT.3.1v1","Expiration days for Anyone links SHALL be set to 30 days or less.","N/A","Shall/Not-Implemented","This policy is only applicable if the external sharing slider on the admin page is set to Anyone. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint31v1 for more info"
"MS.SHAREPOINT.3.2v1","The allowable file and folder permissions for links SHALL be set to View only.","N/A","Shall/Not-Implemented","This policy is only applicable if the external sharing slider on the admin page is set to Anyone. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint32v1 for more info"
"MS.SHAREPOINT.3.3v1","Reauthentication days for people who use a verification code SHALL be set to 30 days or less.","N/A","Shall/Not-Implemented","This policy is only applicable if the external sharing slider on the admin page is set to Anyone or New and Existing Guests. See Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint33v1 for more info"
"MS.TEAMS.1.1v1","External meeting participants SHOULD NOT be enabled to request control of shared desktops or windows.","Pass","Should","Requirement met"
"MS.TEAMS.1.2v1","Anonymous users SHALL NOT be enabled to start meetings.","Pass","Shall","Requirement met"
"MS.TEAMS.1.3v1","Anonymous users and dial-in callers SHOULD NOT be admitted automatically.","Pass","Should","Requirement met"
"MS.TEAMS.1.4v1","Internal users SHOULD be admitted automatically.","Pass","Should","Requirement met"
"MS.TEAMS.1.5v1","Dial-in users SHOULD NOT be enabled to bypass the lobby.","Pass","Should","Requirement met"
"MS.TEAMS.1.6v1","Meeting recording SHOULD be disabled.","Pass","Should","Requirement met"
"MS.TEAMS.1.7v1","Record an event SHOULD be set to Organizer can record.","Pass","Should","Requirement met"
"MS.TEAMS.2.1v1","External access for users SHALL only be enabled on a per-domain basis.","Pass","Shall","Requirement met"
"MS.TEAMS.2.2v1","Unmanaged users SHALL NOT be enabled to initiate contact with internal users.","Pass","Shall","Requirement met"
"MS.TEAMS.2.3v1","Internal users SHOULD NOT be enabled to initiate contact with unmanaged users.","Pass","Should","Requirement met"
"MS.TEAMS.3.1v1","Contact with Skype users SHALL be blocked.","Pass","Shall","Requirement met"
"MS.TEAMS.4.1v1","Teams email integration SHALL be disabled.","Pass","Shall","N/A: Feature is unavailable in GCC environments"
"MS.TEAMS.5.1v1","Agencies SHOULD only allow installation of Microsoft apps approved by the agency.","Pass","Should","Requirement met"
"MS.TEAMS.5.2v1","Agencies SHOULD only allow installation of third-party apps approved by the agency.","Pass","Should","Requirement met"
"MS.TEAMS.5.3v1","Agencies SHOULD only allow installation of custom apps approved by the agency.","Pass","Should","Requirement met"
"MS.TEAMS.6.1v1","A DLP solution SHALL be enabled. The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/teams.md#msteams61v1 for instructions on a manual check."
"MS.TEAMS.6.2v1","The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency. At a minimum, sharing of credit card numbers, taxpayer identification numbers (TINs), and Social Security numbers (SSNs) via email SHALL be restricted.","N/A","Shall/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/teams.md#msteams62v1 for instructions on a manual check."
"MS.TEAMS.7.1v1","Attachments included with Teams messages SHOULD be scanned for malware.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/teams.md#msteams71v1 for instructions on a manual check."
"MS.TEAMS.7.2v1","Users SHOULD be prevented from opening or downloading files detected as malware.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/teams.md#msteams72v1 for instructions on a manual check."
"MS.TEAMS.8.1v1","URL comparison with a blocklist SHOULD be enabled.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/teams.md#msteams81v1 for instructions on a manual check."
"MS.TEAMS.8.2v1","User click tracking SHOULD be enabled.","N/A","Should/3rd Party","A custom product can be used to fulfill this policy requirement. If a custom product is used, a 3rd party assessment tool or manual review is needed to ensure compliance. If you are using Defender for Office 365 to implement this policy, ensure when running ScubaGear that 'defender' is an argument to the -ProductNames parameter. Then, review the corresponding Defender policy that fulfills the requirements of this policy on the Defender ScubaGear HTML report. See the Secure Configuration Baseline policy, https://github.com/cisagov/ScubaGear/blob/v1.5.0/PowerShell/ScubaGear/baselines/teams.md#msteams82v1 for instructions on a manual check."
