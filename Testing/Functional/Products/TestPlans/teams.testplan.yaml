ProductName: teams
TestPlan:
  - PolicyId: MS.TEAMS.1.1v1
    Tests:
      - TestDescription: Allows External Participant Give Request Control
        Preconditions:
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              Identity: Test Draft Teams Minimum Viable Secure Configuration Baseline
              AllowExternalParticipantGiveRequestControl: true
        Postconditions: []
        ExpectedResult: false
      - TestDescription: Does not Allows External Participant Give Request Control
        Preconditions:
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              Identity: Test Draft Teams Minimum Viable Secure Configuration Baseline
              AllowExternalParticipantGiveRequestControl: false
        Postconditions: []
        ExpectedResult: true
  - PolicyId: MS.TEAMS.2.1v1
    Tests:
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              AllowAnonymousUsersToStartMeeting: true
              Identity: Test Draft Teams Minimum Viable Secure Configuration Baseline
        TestDescription: Allows External Participant Give Request Control
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              AllowAnonymousUsersToStartMeeting: false
              Identity: Test Draft Teams Minimum Viable Secure Configuration Baseline
        TestDescription: Does not Allows External Participant Give Request Control
  - PolicyId: MS.TEAMS.3.1v1
    Tests:
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              Identity: Global
              AllowPSTNUsersToBypassLobby: true
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              AutoAdmittedUsers: EveryOne
              Identity: Global
        TestDescription: Dialin bypass lobby - Everyone is autoadmitted user
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              Identity: Global
              AllowPSTNUsersToBypassLobby: true
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              AutoAdmittedUsers: EveryoneInCompany
              Identity: Global
        TestDescription: Dialin bypass lobby - Everyone not auto admitted user
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              Identity: Global
              AllowPSTNUsersToBypassLobby: false
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              AutoAdmittedUsers: EveryoneInCompany
              Identity: Global
        TestDescription: Dialin not bypass lobbyEveryone not auto admitted user
  - PolicyId: MS.TEAMS.4.1v1
    Tests:
    - Postconditions: []
      ExpectedResult: true
      Preconditions:
        - Command: Set-CsTenantFederationConfiguration
          Splat:
            AllowFederatedUsers: false
      TestDescription: Do not allow federated users
  - PolicyId: MS.TEAMS.5.1v1
    Tests:
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTenantFederationConfiguration
            Splat:
              AllowTeamsConsumer: true
              AllowTeamsConsumerInbound: true
        TestDescription: AllowTeamsConsumerInbound - AllowTeamsConsumer
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTenantFederationConfiguration
            Splat:
              AllowTeamsConsumer: false
              AllowTeamsConsumerInbound: true
        TestDescription: AllowTeamsConsumerInbound - Not AllowTeamsConsumer
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTenantFederationConfiguration
            Splat:
              AllowTeamsConsumer: true
              AllowTeamsConsumerInbound: false
        TestDescription: Not AllowTeamsConsumerInbound - AllowTeamsConsumer
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTenantFederationConfiguration
            Splat:
              AllowTeamsConsumer: false
              AllowTeamsConsumerInbound: false
        TestDescription: Not AllowTeamsConsumerInbound - Not AllowTeamsConsumer
  - PolicyId: MS.TEAMS.5.2v1
    Tests:
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTenantFederationConfiguration
            Splat:
              AllowTeamsConsumer: true
        TestDescription: AllowTeamsConsumerInbound - AllowTeamsConsumer
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTenantFederationConfiguration
            Splat:
              AllowTeamsConsumer: false
        TestDescription: AllowTeamsConsumerInbound - Not AllowTeamsConsumer
  - PolicyId: MS.TEAMS.6.1v1
    Tests:
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTenantFederationConfiguration
            Splat:
              AllowPublicUsers: true
        TestDescription: AllowPublicUsers
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTenantFederationConfiguration
            Splat:
              AllowPublicUsers: false
        TestDescription: Not AllowPublicUsers
  - PolicyId: MS.TEAMS.7.1v1
    Tests:
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTeamsClientConfiguration
            Splat:
              AllowEmailIntoChannel: true
        TestDescription: AllowEmailIntoChannel
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTeamsClientConfiguration
            Splat:
              AllowEmailIntoChannel: false
        TestDescription: Not AllowEmailIntoChannel
  - PolicyId: MS.TEAMS.8.1v1
    Tests:
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTeamsAppPermissionPolicy
            Splat:
              DefaultCatalogAppsType: BlockedAppList
              Identity: Global
        TestDescription: BlockedAppList
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTeamsAppPermissionPolicy
            Splat:
              DefaultCatalogAppsType: AllowedAppList
              Identity: Global
        TestDescription: AllowedAppList
  - PolicyId: MS.TEAMS.8.2v1
    Tests:
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTeamsAppPermissionPolicy
            Splat:
              Identity: Global
              GlobalCatalogAppsType: BlockedAppList
              PrivateCatalogAppsType: BlockedAppList
        TestDescription: GlobalCatalogAppsType:Block - PrivateCatalogAppsType:Block
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTeamsAppPermissionPolicy
            Splat:
              Identity: Global
              GlobalCatalogAppsType: AllowedAppList
              PrivateCatalogAppsType: BlockedAppList
        TestDescription: GlobalCatalogAppsType:Allow - PrivateCatalogAppsType:Block
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTeamsAppPermissionPolicy
            Splat:
              Identity: Global
              GlobalCatalogAppsType: BlockedAppList
              PrivateCatalogAppsType: AllowedAppList
        TestDescription: GlobalCatalogAppsType:Block - PrivateCatalogAppsType:Allow
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTeamsAppPermissionPolicy
            Splat:
              Identity: Global
              GlobalCatalogAppsType: AllowedAppList
              PrivateCatalogAppsType: AllowedAppList
        TestDescription: GlobalCatalogAppsType:Allow - PrivateCatalogAppsType:Allow
  - PolicyId: MS.TEAMS.8.3v1
    Tests:
    - TestDescription: Not Checked
      Preconditions: []
      Postconditions: []
      IsNotChecked: true
      ExpectedResult: false
  - PolicyId: MS.TEAMS.9.1v1
    Tests:
    - Postconditions: []
      ExpectedResult: false
      Preconditions:
        - Command: Set-CsTeamsMeetingPolicy
          Splat:
            AllowCloudRecording: true
            Identity: Global
      TestDescription: AllowCloudRecording
    - Postconditions: []
      ExpectedResult: true
      Preconditions:
        - Command: Set-CsTeamsMeetingPolicy
          Splat:
            AllowCloudRecording: false
            Identity: Global
      TestDescription: Not AllowCloudRecording
  - PolicyId: MS.TEAMS.9.3v1
    Tests:
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              AllowRecordingStorageOutsideRegion: true
              Identity: Global
              AllowCloudRecording: true
        TestDescription: AllowCloudRecording:true - AllowRecordingStorageOutsideRegion:true
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              AllowRecordingStorageOutsideRegion: false
              Identity: Global
              AllowCloudRecording: true
        TestDescription: AllowCloudRecording:true - AllowRecordingStorageOutsideRegion:false
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              AllowRecordingStorageOutsideRegion: true
              Identity: Global
              AllowCloudRecording: false
        TestDescription: AllowCloudRecording:false - AllowRecordingStorageOutsideRegion:true
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTeamsMeetingPolicy
            Splat:
              AllowRecordingStorageOutsideRegion: false
              Identity: Global
              AllowCloudRecording: false
        TestDescription: AllowCloudRecording:false - AllowRecordingStorageOutsideRegion:false
  - PolicyId: MS.TEAMS.10.1v1
    Tests:
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTeamsMeetingBroadcastPolicy
            Splat:
              BroadcastRecordingMode: AlwaysEnabled
              Identity: Global
        TestDescription: BroadcastRecordingMode:AlwaysEnabled
      - Postconditions: []
        ExpectedResult: false
        Preconditions:
          - Command: Set-CsTeamsMeetingBroadcastPolicy
            Splat:
              BroadcastRecordingMode: AlwaysDisabled
              Identity: Global
        TestDescription: BroadcastRecordingMode:AlwaysDisabled
      - Postconditions: []
        ExpectedResult: true
        Preconditions:
          - Command: Set-CsTeamsMeetingBroadcastPolicy
            Splat:
              BroadcastRecordingMode: UserOverride
              Identity: Global
        TestDescription: BroadcastRecordingMode:UserOverride
  - PolicyId: MS.TEAMS.11.1v1
    Tests:
      - TestDescription: Custom Implementation
        Preconditions: []
        Postconditions: []
        IsCustomImplementation: true
        ExpectedResult: false    
  - PolicyId: MS.TEAMS.11.2v1
    Tests:
      - IsCustomImplementation: true
        Postconditions: []
        ExpectedResult: false
        Preconditions: []
        TestDescription: Custom Implementation
  - PolicyId: MS.TEAMS.11.4v1
    Tests:
      - IsCustomImplementation: true
        Postconditions: []
        ExpectedResult: false
        Preconditions: []
        TestDescription: Custom Implementation
  - PolicyId: MS.TEAMS.12.1v1
    Tests:
      - IsCustomImplementation: true
        Postconditions: []
        ExpectedResult: false
        Preconditions: []
        TestDescription: Custom Implementation
  - PolicyId: MS.TEAMS.12.2v1
    Tests:
      - IsCustomImplementation: true
        Postconditions: []
        ExpectedResult: false
        Preconditions: []
        TestDescription: Custom Implementation
  - PolicyId: MS.TEAMS.13.1v1
    Tests:
      - IsCustomImplementation: true
        Postconditions: []
        ExpectedResult: false
        Preconditions: []
        TestDescription: Custom Implementation
  - PolicyId: MS.TEAMS.13.2v1
    Tests:
      - IsCustomImplementation: true
        Postconditions: []
        ExpectedResult: false
        Preconditions: []
        TestDescription: Custom Implementation
  - PolicyId: MS.TEAMS.13.3v1
    Tests:
      - IsCustomImplementation: true
        Postconditions: []
        ExpectedResult: false
        Preconditions: []
        TestDescription: Custom Implementation

