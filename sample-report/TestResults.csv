"ActualValue","Commandlet","Control","Criticality","ReportDetails","Requirement","RequirementMet"
"false","Get-MgPolicyAdminConsentRequestPolicy","AAD 2.7","Shall","Requirement not met","An admin consent workflow SHALL be configured","False"
"true","Get-MgPolicyAuthorizationPolicy","AAD 2.6","Shall","Requirement not met","Only administrators SHALL be allowed to register third-party applications","False"
"""""","Get-MgDirectoryRoleMember","AAD 2.12","Shall","0 admin(s) that are not cloud-only found","Users that need to be assigned to highly privileged Azure AD roles SHALL be provisioned cloud-only accounts that are separate from the on-premises directory or other federated identity providers","True"
"""Role ID : 10dae51f-b6af-4016-8d66-8c2a99b929b3""","Get-MgPolicyAuthorizationPolicy","AAD 2.18","Should","Permission level set to ""Limited access""","Guest users SHOULD have limited access to Azure AD directory objects","True"
"""[ManagePermissionGrantsForSelf.microsoft-user-default-legacy]""","Get-MgPolicyAuthorizationPolicy","AAD 2.7","Shall","Requirement not met","Only administrators SHALL be allowed to consent to third-party applications","False"
"""everyone""","Get-MgPolicyAuthorizationPolicy","AAD 2.18","Should","Requirement not met","Only users with the Guest Inviter role SHOULD be able to invite guest users","False"
,"","AAD 2.18","Should/Not-Implemented","Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.18 for instructions on manual check","Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes","False"
,"","AAD 2.2","Should/Not-Implemented","Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.2 for instructions on manual check","A notification SHOULD be sent to the administrator when high-risk users are detected","False"
,"","AAD 2.4","Shall/Not-Implemented","Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.4 for instructions on manual check","If phishing-resistant MFA cannot be used, an MFA method from the list [see AAD baseline 2.4] SHALL be used in the interim","False"
,"","AAD 2.4","Shall/Not-Implemented","Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.4 for instructions on manual check","Phishing-resistant MFA SHALL be used for all users","False"
,"","AAD 2.4","Shall/Not-Implemented","Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.4 for instructions on manual check","SMS or Voice as the MFA method SHALL NOT be used","False"
,"","AAD 2.5","Shall/Not-Implemented","Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.5 for instructions on manual check","The following critical logs SHALL be sent at a minimum: AuditLogs, SignInLogs, RiskyUsers, UserRiskEvents, NonInteractiveUserSignInLogs, ServicePrincipalSignInLogs, ADFSSignInLogs, RiskyServicePrincipals, ServicePrincipalRiskEvents","False"
,"","AAD 2.5","Shall/Not-Implemented","Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.5 for instructions on manual check","The logs SHALL be sent to the agency's SOC for monitoring","False"
,"","AAD 2.8","Shall/Not-Implemented","Currently cannot be checked automatically. See Azure Active Directory Secure Configuration Baseline policy 2.8 for instructions on manual check","User passwords SHALL NOT expire","False"
,"Get-MgIdentityConditionalAccessPolicy","AAD 2.1","Shall","0 conditional access policy(s) found that meet(s) all requirements","Legacy authentication SHALL be blocked","False"
,"Get-MgIdentityConditionalAccessPolicy","AAD 2.10","Shall","0 conditional access policy(s) found that meet(s) all requirements","Browser sessions SHALL not be persistent","False"
,"Get-MgIdentityConditionalAccessPolicy","AAD 2.13","Shall","0 conditional access policy(s) found that meet(s) all requirements","MFA SHALL be required for user access to highly privileged roles","False"
,"Get-MgIdentityConditionalAccessPolicy","AAD 2.17","Should","0 conditional access policy(s) found that meet(s) all requirements","Managed devices SHOULD be required for authentication","False"
,"Get-MgIdentityConditionalAccessPolicy","AAD 2.2","Shall","0 conditional access policy(s) found that meet(s) all requirements","Users detected as high risk SHALL be blocked","False"
,"Get-MgIdentityConditionalAccessPolicy","AAD 2.3","Shall","0 conditional access policy(s) found that meet(s) all requirements","Sign-ins detected as high risk SHALL be blocked","False"
,"Get-MgIdentityConditionalAccessPolicy","AAD 2.4","Shall","0 conditional access policy(s) found that meet(s) all requirements","MFA SHALL be required for all users","False"
,"Get-MgIdentityConditionalAccessPolicy","AAD 2.9","Shall","0 conditional access policy(s) found that meet(s) all requirements","Sign-in frequency SHALL be configured to 12 hours","False"
"[""Application Administrator"",""Cloud Application Administrator"",""Exchange Administrator"",""Global Administrator"",""Hybrid Identity Administrator"",""Privileged Role Administrator"",""SharePoint Administrator"",""User Administrator""]","Get-MgRoleManagementDirectoryRoleAssignmentScheduleInstance","AAD 2.14","Shall","8 role(s) configured to allow permanent active assignment or expiration period too long:<br/>Application Administrator, Cloud Application Administrator, Exchange Administrator, Global Administrator, Hybrid Identity Administrator, Privileged Role Administrator, SharePoint Administrator, User Administrator","Permanent active role assignments SHALL NOT be allowed for highly privileged roles. Active assignments SHALL have an expiration period.","False"
"[""Application Administrator"",""Cloud Application Administrator"",""Exchange Administrator"",""Global Administrator"",""Hybrid Identity Administrator"",""Privileged Role Administrator"",""SharePoint Administrator"",""User Administrator""]","Get-MgRoleManagementDirectoryRoleAssignmentScheduleInstance","AAD 2.15","Should","8 role(s) that do not require approval to activate found:<br/>Application Administrator, Cloud Application Administrator, Exchange Administrator, Global Administrator, Hybrid Identity Administrator, Privileged Role Administrator, SharePoint Administrator, User Administrator","Activation of highly privileged roles SHOULD require approval","False"
"[""Application Administrator"",""Cloud Application Administrator"",""Exchange Administrator"",""Global Administrator"",""Hybrid Identity Administrator"",""Privileged Role Administrator"",""SharePoint Administrator"",""User Administrator""]","Get-MgRoleManagementDirectoryRoleAssignmentScheduleInstance","AAD 2.16","Shall","8 role(s) without notification e-mail configured for role assignments found:<br/>Application Administrator, Cloud Application Administrator, Exchange Administrator, Global Administrator, Hybrid Identity Administrator, Privileged Role Administrator, SharePoint Administrator, User Administrator","Eligible and Active highly privileged role assignments SHALL trigger an alert","False"
"[""Application Administrator"",""Cloud Application Administrator"",""Exchange Administrator"",""Global Administrator"",""Hybrid Identity Administrator"",""Privileged Role Administrator"",""SharePoint Administrator"",""User Administrator""]","Get-MgRoleManagementDirectoryRoleAssignmentScheduleInstance","AAD 2.16","Shall","Requirement not met","User activation of the Global Administrator role SHALL trigger an alert","False"
"[""Application Administrator"",""Cloud Application Administrator"",""Exchange Administrator"",""Hybrid Identity Administrator"",""Privileged Role Administrator"",""SharePoint Administrator"",""User Administrator""]","Get-MgRoleManagementDirectoryRoleAssignmentScheduleInstance","AAD 2.16","Should","7 role(s) without notification e-mail configured for role activations found:<br/>Application Administrator, Cloud Application Administrator, Exchange Administrator, Hybrid Identity Administrator, Privileged Role Administrator, SharePoint Administrator, User Administrator","User activation of other highly privileged roles SHOULD trigger an alert","False"
"""FNU LNU""","Get-MgDirectoryRoleMember","AAD 2.11","Shall","1 global admin(s) found:<br/>FNU LNU","A minimum of two users and a maximum of four users SHALL be provisioned with the Global Administrator role","False"
"""Global Administrator""","Get-MgRoleManagementDirectoryRoleAssignmentScheduleInstance","AAD 2.14","Shall","1 role(s) assigned to users outside of PIM:<br/>Global Administrator","Provisioning of users to highly privileged roles SHALL NOT occur outside of a PAM system, such as the Azure AD PIM service, because this bypasses the controls the PAM system provides","False"
"false","Get-AntiPhishPolicy","Defender 2.5","Shall","Requirement not met","All safety tips SHALL be enabled: domain impersonation default policy","False"
"false","Get-AntiPhishPolicy","Defender 2.5","Shall","Requirement not met","All safety tips SHALL be enabled: first contact default policy","False"
"false","Get-AntiPhishPolicy","Defender 2.5","Shall","Requirement not met","All safety tips SHALL be enabled: user impersonation default policy","False"
"false","Get-AntiPhishPolicy","Defender 2.5","Shall","Requirement not met","All safety tips SHALL be enabled: user impersonation unusual characters default policy","False"
"true","Get-AntiPhishPolicy","Defender 2.5","Shall","Requirement met","All safety tips SHALL be enabled: ""?"" for unauthenticated senders for spoof default policy","True"
"true","Get-AntiPhishPolicy","Defender 2.5","Shall","Requirement met","All safety tips SHALL be enabled: ""via"" tag default policy","True"
"true","Get-HostedContentFilterPolicy","Defender 2.6","Shall","Requirement met","Zero-hour auto purge (ZAP) SHALL be enabled for phishing: default policy","True"
"true","Get-HostedContentFilterPolicy","Defender 2.6","Shall","Requirement met","Zero-hour auto purge (ZAP) SHALL be enabled for spam messages: default policy","True"
"true","Get-HostedContentFilterPolicy","Defender 2.6","Shall","Requirement met","Zero-hour auto purge (ZAP) SHALL be enabled: default policy","True"
"true","Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","Spam safety tips SHOULD be turned on: default policy","True"
"7","Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement not met","The bulk complaint level (BCL) threshold SHOULD be set to six or lower: default policy","False"
"15","Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement not met","Spam in quarantine SHOULD be retained for at least 30 days: default policy","False"
"""MoveToJmf""","Get-AntiPhishPolicy","Defender 2.5","Shall","Requirement not met","Mail classified as spoofed SHALL be quarantined: default policy","False"
"""MoveToJmf""","Get-HostedContentFilterPolicy","Defender 2.6","Shall","Requirement met","High confidence spam SHALL be moved to either the junk email folder or the quarantine folder: default policy","True"
"""MoveToJmf""","Get-HostedContentFilterPolicy","Defender 2.6","Shall","Requirement met","Spam SHALL be moved to either the junk email folder or the quarantine folder: default policy","True"
"""MoveToJmf""","Get-HostedContentFilterPolicy","Defender 2.6","Shall","Requirement not met","Phishing SHALL be quarantined: default policy","False"
"""MoveToJmf""","Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","Bulk email SHOULD be moved to either the junk email folder or the quarantine folder: default policy","True"
"""NoAction""","Get-AntiPhishPolicy","Defender 2.5","Shall","Requirement not met","Message action SHALL be set to quarantine if the message is detected as impersonated: domains default policy","False"
"""NoAction""","Get-AntiPhishPolicy","Defender 2.5","Shall","Requirement not met","Message action SHALL be set to quarantine if the message is detected as impersonated: mailbox default policy","False"
"""NoAction""","Get-AntiPhishPolicy","Defender 2.5","Shall","Requirement not met","Message action SHALL be set to quarantine if the message is detected as impersonated: users default policy","False"
"""Quarantine""","Get-HostedContentFilterPolicy","Defender 2.6","Shall","Requirement met","High confidence phishing SHALL be quarantined: default policy","True"
,"","Defender 2.10","Shall/Not-Implemented","Currently cannot be checked automatically. See Defender Secure Configuration Baseline policy 2.10 for instructions on manual check","Advanced audit SHALL be enabled","False"
,"","Defender 2.10","Shall/Not-Implemented","Currently cannot be checked automatically. See Defender Secure Configuration Baseline policy 2.10 for instructions on manual check","Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31","False"
,"","Defender 2.2","Should/Not-Implemented","Currently cannot be checked automatically. See Defender Secure Configuration Baseline policy 2.2 for instructions on manual check","A list of apps that are not allowed to access files protected by DLP policy SHOULD be defined","False"
,"","Defender 2.2","Should/Not-Implemented","Currently cannot be checked automatically. See Defender Secure Configuration Baseline policy 2.2 for instructions on manual check","A list of browsers that are not allowed to access files protected by DLP policy SHOULD be defined","False"
,"","Defender 2.9","Should/Not-Implemented","Currently cannot be checked automatically. See Defender Secure Configuration Baseline policy 2.9 for instructions on manual check","The alerts SHOULD be sent to a monitored address or incorporated into a SIEM","False"
,"Get-AdminAuditLogConfig","Defender 2.10","Shall","Requirement not met","Unified audit logging SHALL be enabled","False"
,"Get-AntiPhishPolicy","Defender 2.5","Should","No users are included for targeted user protection.","User impersonation protection SHOULD be enabled for key agency leaders","False"
,"Get-AntiPhishPolicy","Defender 2.5","Should","Requirement met","All safety tips SHOULD be enabled: ""?"" for unauthenticated senders for spoof non-default policies","True"
,"Get-AntiPhishPolicy","Defender 2.5","Should","Requirement met","All safety tips SHOULD be enabled: ""via"" tag non-default policies","True"
,"Get-AntiPhishPolicy","Defender 2.5","Should","Requirement met","All safety tips SHOULD be enabled: domain impersonation non-default policies","True"
,"Get-AntiPhishPolicy","Defender 2.5","Should","Requirement met","All safety tips SHOULD be enabled: first contact non-default policies","True"
,"Get-AntiPhishPolicy","Defender 2.5","Should","Requirement met","All safety tips SHOULD be enabled: user impersonation non-default policies","True"
,"Get-AntiPhishPolicy","Defender 2.5","Should","Requirement met","All safety tips SHOULD be enabled: user impersonation unusual characters non-default policies","True"
,"Get-AntiPhishPolicy","Defender 2.5","Should","Requirement met","Mail classified as spoofed SHOULD be quarantined: non-default policies","True"
,"Get-AntiPhishPolicy","Defender 2.5","Should","Requirement met","Message action SHOULD be set to quarantine if the message is detected as impersonated: domains non-default policies","True"
,"Get-AntiPhishPolicy","Defender 2.5","Should","Requirement met","Message action SHOULD be set to quarantine if the message is detected as impersonated: mailbox non-default policies","True"
,"Get-AntiPhishPolicy","Defender 2.5","Should","Requirement met","Message action SHOULD be set to quarantine if the message is detected as impersonated: users non-default policies","True"
,"Get-AntiPhishPolicy","Defender 2.5","Should","Requirement not met","Domain impersonation protection SHOULD be enabled for domains owned by the agency","False"
,"Get-AntiPhishPolicy","Defender 2.5","Should","Requirement not met","Intelligence for impersonation protection SHALL be enabled","False"
,"Get-AntiPhishPolicy","Defender 2.5","Should","The Custom Domains protection policies: Enabled, EnableTargetedDomainsProtection, and TargetedDomainsToProtect are not set correctly","Domain impersonation protection SHOULD be added for frequent partners","False"
,"Get-AtpPolicyForO365","Defender 2.8","Should","Requirement not met","Safe attachments SHOULD be enabled for SharePoint, OneDrive, and Microsoft Teams","False"
,"Get-DLPCompliancePolicy","Defender 2.2","Should","No policy found that applies to OneDrive.","The custom policy SHOULD be applied in OneDrive","False"
,"Get-DlpComplianceRule","Defender 2.2","Shall","No matching rule found for U.S. Individual Taxpayer Identification Number (ITIN)","A custom policy SHALL be configured to protect PII and sensitive information, as defined by the agency: U.S. Individual Taxpayer Identification Number (ITIN)","False"
,"Get-DlpComplianceRule","Defender 2.2","Shall","No matching rule found for U.S. Social Security Number (SSN)","A custom policy SHALL be configured to protect PII and sensitive information, as defined by the agency: U.S. Social Security Number (SSN)","False"
,"Get-EOPProtectionPolicyRule","Defender 2.1","Should","Requirement met","Standard Preset security profiles SHOULD NOT be used","True"
,"Get-EOPProtectionPolicyRule","Defender 2.1","Should","Requirement met","Strict Preset security profiles SHOULD NOT be used","True"
,"Get-HostedContentFilterPolicy","Defender 2.6","Shall","Requirement met","Allowed senders MAY be added but allowed domains SHALL NOT be added: default policy","True"
,"Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","Allowed senders MAY be added but allowed domains SHOULD NOT be added: non-default","True"
,"Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","Bulk email SHOULD be moved to either the junk email folder or the quarantine folder: non-default policies","True"
,"Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","High confidence phishing SHOULD be quarantined: non-default policies","True"
,"Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","High confidence spam SHOULD be moved to either the junk email folder or the quarantine folder: non-default policies","True"
,"Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","Phishing SHOULD be quarantined: non-default policies","True"
,"Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","Spam SHOULD be moved to either the junk email folder or the quarantine folder: non-default policies","True"
,"Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","Spam in quarantine SHOULD be retained for at least 30 days: non-default policies","True"
,"Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","Spam safety tips SHOULD be turned on: non-default policies","True"
,"Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","The bulk complaint level (BCL) threshold SHOULD be set to six or lower: non-default policies","True"
,"Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","Zero-hour auto purge (ZAP) SHOULD be enabled for Spam: non-default","True"
,"Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","Zero-hour auto purge (ZAP) SHOULD be enabled for phishing: non-default","True"
,"Get-HostedContentFilterPolicy","Defender 2.6","Should","Requirement met","Zero-hour auto purge (ZAP) SHOULD be enabled: non-default","True"
,"Get-MalwareFilterPolicy","Defender 2.3","Should","No malware policies found that block .cmd files.","Disallowed file types SHALL be determined and set. At a minimum, click-to-run files SHOULD be blocked: cmd files","False"
,"Get-MalwareFilterPolicy","Defender 2.3","Should","No malware policies found that block .exe files.","Disallowed file types SHALL be determined and set. At a minimum, click-to-run files SHOULD be blocked: exe files","False"
,"Get-MalwareFilterPolicy","Defender 2.3","Should","No malware policies found that block .vbe files.","Disallowed file types SHALL be determined and set. At a minimum, click-to-run files SHOULD be blocked: vbe files","False"
,"Get-MalwareFilterPolicy","Defender 2.4","Should","Requirement met","Zero-hour Auto Purge (ZAP) for malware SHOULD be enabled in the default anti-malware policy and in all existing custom policies","True"
,"Get-SafeAttachmentPolicy, Get-SafeAttachmentRule, Get-AcceptedDomain","Defender 2.8","Shall","No enabled policy found with action set to block that apply to all domains","The action for malware in email attachments SHALL be set to block","False"
,"Get-SafeAttachmentPolicy, Get-SafeAttachmentRule, Get-AcceptedDomain","Defender 2.8","Should","No enabled policy found with action set to block and at least one contact specified","Redirect emails with detected attachments to an agency-specified email SHOULD be enabled","False"
,"Get-SafeAttachmentRule, Get-AcceptedDomain","Defender 2.8","Shall","No policy found that applies to all domains: tqhjy.onmicrosoft.com","At least one Safe Attachments Policy SHALL include all agency domains-and by extension-all users","False"
,"Get-SafeLinksPolicy, Get-SafeLinksRule","Defender 2.7","Shall","Requirement not met","Internal agency email messages SHALL have safe links enabled","False"
,"Get-SafeLinksPolicy, Get-SafeLinksRule","Defender 2.7","Shall","Requirement not met","Malicious link click checking SHALL be enabled with Microsoft Teams","False"
,"Get-SafeLinksPolicy, Get-SafeLinksRule","Defender 2.7","Shall","Requirement not met","Real-time suspicious URL and file-link scanning SHALL be enabled","False"
,"Get-SafeLinksPolicy, Get-SafeLinksRule","Defender 2.7","Shall","Requirement not met","Safe Links in Office 365 apps SHALL be turned on","False"
,"Get-SafeLinksPolicy, Get-SafeLinksRule","Defender 2.7","Shall","Requirement not met","URL rewriting and malicious link click checking SHALL be enabled","False"
,"Get-SafeLinksPolicy, Get-SafeLinksRule","Defender 2.7","Shall","Requirement not met","URLs SHALL be scanned completely before message delivery","False"
,"Get-SafeLinksPolicy, Get-SafeLinksRule","Defender 2.7","Shall","Requirement not met","User click tracking SHALL be enabled","False"
,"Get-SafeLinksPolicy, Get-SafeLinksRule","Defender 2.7","Shall","Requirement not met","Users SHALL NOT be enabled to click through to the original URL","False"
,"Get-SafeLinksRule, Get-AcceptedDomain","Defender 2.7","Shall","No policy found that applies to all domains: tqhjy.onmicrosoft.com","The Safe Links Policy SHALL include all agency domains-and by extension-all users","False"
"""Default""","Get-MalwareFilterPolicy","Defender 2.3","Shall","1 malware policy(ies) found that do(es) not have the common attachments filter enabled: Default","The common attachments filter SHALL be enabled in the default anti-malware policy and in all existing policies","False"
"""Default Teams DLP policy rule""","Get-DlpComplianceRule","Defender 2.2","Should","1 rule(s) found that do(es) not notify at least one user: Default Teams DLP policy rule","Notifications to inform users and help educate them on the proper use of sensitive information SHOULD be enabled","False"
"[""Default Teams DLP policy rule"",""Items containing 1-9 credit card numbers shared externally"",""Items with 10 or more credit card numbers shared externally""]","Get-DlpComplianceRule","Defender 2.2","Shall","Requirement met","A custom policy SHALL be configured to protect PII and sensitive information, as defined by the agency: Credit Card Number","True"
"[""Default Teams DLP policy rule"",""Items containing 1-9 credit card numbers shared externally"",""Items with 10 or more credit card numbers shared externally""]","Get-DlpComplianceRule","Defender 2.2","Should","3 rule(s) found that do(es) not block access: Default Teams DLP policy rule, Items containing 1-9 credit card numbers shared externally, Items with 10 or more credit card numbers shared externally","The action for the DLP policy SHOULD be set to block sharing sensitive information with everyone when DLP conditions are met","False"
"[""Malware campaign detected after delivery"",""Unusual increase in email reported as phish""]","Get-ProtectionAlert","Defender 2.9","Shall","2 disabled required alert(s) found: Malware campaign detected after delivery, Unusual increase in email reported as phish","At a minimum, the alerts required by the Exchange Online Minimum Viable Secure Configuration Baseline SHALL be enabled","False"
"{""Locations"":[""All""],""Name"":""Default Office 365 DLP policy"",""Workload"":""Exchange, SharePoint, OneDriveForBusiness""}","Get-DLPCompliancePolicy","Defender 2.2","Should","Requirement met","The custom policy SHOULD be applied in Exchange","True"
"{""Locations"":[""All""],""Name"":""Default Office 365 DLP policy"",""Workload"":""Exchange, SharePoint, OneDriveForBusiness""}","Get-DLPCompliancePolicy","Defender 2.2","Should","Requirement met","The custom policy SHOULD be applied in SharePoint","True"
"{""Locations"":[""All""],""Name"":""Default policy for Teams"",""Workload"":""Exchange, SharePoint, OneDriveForBusiness, Teams""}","Get-DLPCompliancePolicy","Defender 2.2","Should","Requirement met","The custom policy SHOULD be applied in Teams","True"
"false","Get-HostedConnectionFilterPolicy","EXO 2.12","Should","Requirement met","Safe lists SHOULD NOT be enabled","True"
"false","Get-OrganizationConfig","EXO 2.13","Shall","Requirement met","Mailbox auditing SHALL be enabled","True"
"true","Get-TransportConfig","EXO 2.5","Shall","Requirement met","SMTP AUTH SHALL be disabled in Exchange Online","True"
,"","EXO 2.10","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Emails SHALL be scanned for malware","False"
,"","EXO 2.10","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Emails identified as containing malware SHALL be quarantined or dropped","False"
,"","EXO 2.10","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Email scanning SHOULD be capable of reviewing emails after delivery","False"
,"","EXO 2.11","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Impersonation protection checks SHOULD be used","False"
,"","EXO 2.11","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence","False"
,"","EXO 2.11","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed","False"
,"","EXO 2.14","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","A spam filter SHALL be enabled. The filtering solution selected SHOULD offer services comparable to the native spam filtering offered by Microsoft","False"
,"","EXO 2.14","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Allowed senders MAY be added, but allowed domains SHALL NOT be added","False"
,"","EXO 2.14","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder","False"
,"","EXO 2.15","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Direct download links SHOULD be scanned for malware","False"
,"","EXO 2.15","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","URL comparison with a block-list SHOULD be enabled","False"
,"","EXO 2.15","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","User click tracking SHOULD be enabled","False"
,"","EXO 2.16","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","At a minimum, the following alerts SHALL be enabled...[see Exchange Online secure baseline for list]","False"
,"","EXO 2.16","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","The alerts SHOULD be sent to a monitored address or incorporated into a SIEM","False"
,"","EXO 2.17","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Advanced audit SHALL be enabled","False"
,"","EXO 2.17","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31","False"
,"","EXO 2.17","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Unified audit logging SHALL be enabled","False"
,"","EXO 2.2","Shall/Not-Implemented","Currently cannot be checked automatically. See Exchange Online Secure Configuration Baseline policy 2.# for instructions on manual check","A list of approved IP addresses for sending mail SHALL be maintained","False"
,"","EXO 2.8","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","A DLP solution SHALL be used. The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft","False"
,"","EXO 2.8","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","The DLP solution SHALL protect PII and sensitive information, as defined by the agency. At a minimum, the sharing of credit card numbers, Taxpayer Identification Numbers (TIN), and Social Security Numbers (SSN) via email SHALL be restricted","False"
,"","EXO 2.9","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Disallowed file types SHALL be determined and set. At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe)","False"
,"","EXO 2.9","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Emails SHALL be filtered by the file types of included attachments. The selected filtering solution SHOULD offer services comparable to Microsoft Defender's Common Attachment Filter","False"
,"","EXO 2.9","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","The attachment filter SHOULD attempt to determine the true file type and assess the file extension","False"
,"Get-HostedConnectionFilterPolicy","EXO 2.12","Should","Requirement met","IP allow lists SHOULD NOT be created","True"
,"Get-TransportRule","EXO 2.7","Shall","No transport rule found with that applies to emails received from outside the organization","External sender warnings SHALL be implemented","False"
"[""Anonymous:CalendarSharingFreeBusyReviewer"",""*:CalendarSharingFreeBusySimple""]","Get-SharingPolicy","EXO 2.6","Shall","Requirement met","Calendar details SHALL NOT be shared with all domains, although they MAY be shared with specific domains","True"
"[""Anonymous:CalendarSharingFreeBusyReviewer"",""*:CalendarSharingFreeBusySimple""]","Get-SharingPolicy","EXO 2.6","Shall","Requirement met","Contact folders SHALL NOT be shared with all domains, although they MAY be shared with specific domains","True"
"[{""value"":[{""domain"":""tqhjy.onmicrosoft.com"",""rdata"":""""}],""Count"":1},{""value"":[],""Count"":0}]","Get-DkimSigningConfig, Resolve-DnsName","EXO 2.3","Should","Requirement met","DKIM SHOULD be enabled for any custom domain","True"
"{""domain"":""tqhjy.onmicrosoft.com"",""rdata"":""""}","Resolve-DnsName","EXO 2.4","Shall","1 of 1 agency domain(s) found in violation: tqhjy.onmicrosoft.com","A DMARC policy SHALL be published for every second-level domain","False"
"{""domain"":""tqhjy.onmicrosoft.com"",""rdata"":""""}","Resolve-DnsName","EXO 2.4","Shall","1 of 1 agency domain(s) found in violation: tqhjy.onmicrosoft.com","An agency point of contact SHOULD be included for aggregate and/or failure reports","False"
"{""domain"":""tqhjy.onmicrosoft.com"",""rdata"":""""}","Resolve-DnsName","EXO 2.4","Shall","1 of 1 agency domain(s) found in violation: tqhjy.onmicrosoft.com","The DMARC message rejection option SHALL be ""p=reject""","False"
"{""domain"":""tqhjy.onmicrosoft.com"",""rdata"":""""}","Resolve-DnsName","EXO 2.4","Shall","1 of 1 agency domain(s) found in violation: tqhjy.onmicrosoft.com","The DMARC point of contact for aggregate reports SHALL include reports@dmarc.cyber.dhs.gov","False"
,"Resolve-DnsName","EXO 2.2","Shall","Requirement met","An SPF policy(s) that designates only these addresses as approved senders SHALL be published","True"
"""*""","Get-RemoteDomain","EXO 2.1","Shall","1 remote domain(s) that allows automatic forwarding: *","Automatic forwarding to external domains SHALL be disabled","False"
,"","OneDrive 2.6","Shall/Not-Implemented","Currently cannot be checked automatically. See Onedrive Secure Configuration Baseline policy 2.6 for instructions on manual check","OneDrive Client Sync SHALL be restricted to the local domain","False"
,"","OneDrive 2.7","Shall/Not-Implemented","Currently cannot be checked automatically. See Onedrive Secure Configuration Baseline policy 2.7 for instructions on manual check","Legacy Authentication SHALL be blocked","False"
,"Get-SPOTenant","OneDrive 2.1","Should","Requirement not met","Anyone links SHOULD be disabled","False"
,"Get-SPOTenant","OneDrive 2.2","Should","Requirement not met","An expiration date SHOULD be set for Anyone links","False"
,"Get-SPOTenant","OneDrive 2.2","Should","Requirement not met","Expiration date SHOULD be set to thirty days","False"
,"Get-SPOTenant","OneDrive 2.3","Should","Requirement not met","Anyone link permissions SHOULD be limited to View","False"
,"Get-SPOTenant","OneDrive 2.4","Shall","Requirement not met","OneDrive Client for Windows SHALL be restricted to agency-Defined Domain(s)","False"
"{""AllowedDomainList"":[],""BlockMacSync"":false,""DisableReportProblemDialog"":false,""ExcludedFileExtensions"":[""""],""OptOutOfGrooveBlock"":false,""OptOutOfGrooveSoftBlock"":false,""TenantRestrictionEnabled"":false}","Get-SPOTenantSyncClientRestriction","OneDrive 2.5","Shall","Requirement met","OneDrive Client Sync SHALL only be allowed only within the local domain","True"
,"","Sharepoint 2.3","Should/Not-Implemented","Currently cannot be checked automatically. See Sharepoint Secure Configuration Baseline policy 2.3 for instructions on manual check","Sharing settings for specific SharePoint sites SHOULD align to their sensitivity level","False"
,"","Sharepoint 2.5","Shall/Not-Implemented","Currently cannot be checked automatically. See Sharepoint Secure Configuration Baseline policy 2.5 for instructions on manual check","Users SHALL be prevented from running custom scripts on personal sites (OneDrive)","False"
,"Get-SPOTenant","Sharepoint 2.1","Shall","Requirement not met","File and folder links default sharing setting SHALL be set to ""Specific People (Only the People the User Specifies)""","False"
,"Get-SPOTenant","Sharepoint 2.2","Should","Requirement not met","External sharing SHOULD be limited to approved domains and security groups per interagency collaboration needs","False"
,"Get-SPOTenant","Sharepoint 2.4","Should","Requirement not met","Expiration timers SHOULD be set to 30 days","False"
,"Get-SPOTenant","Sharepoint 2.4","Should","Requirement not met","Expiration timers for 'guest access to a site or OneDrive' and 'people who use a verification code' SHOULD be set","False"
"{""AllowDownloadingNonWebViewableFiles"":false,""AllowEditing"":true,""AllowSelfServiceUpgrade"":true,""AnonymousLinkExpirationInDays"":0,""AuthenticationContextName"":null,""BlockDownloadLinksFileType"":1,""BlockDownloadPolicy"":false,""CommentsOnSitePagesDisabled"":false,""CompatibilityLevel"":15,""ConditionalAccessPolicy"":0,""DefaultLinkPermission"":0,""DefaultLinkToExistingAccess"":false,""DefaultShareLinkRole"":0,""DefaultShareLinkScope"":0,""DefaultSharingLinkType"":0,""DenyAddAndCustomizePages"":2,""DisableAppViews"":2,""DisableCompanyWideSharingLinks"":2,""DisableFlows"":2,""DisableSharingForNonOwnersStatus"":null,""ExcludeBlockDownloadPolicySiteOwners"":false,""ExcludedBlockDownloadGroupIds"":[],""ExternalUserExpirationInDays"":0,""GroupId"":""00000000-0000-0000-0000-000000000000"",""HubSiteId"":""00000000-0000-0000-0000-000000000000"",""InformationBarriersMode"":"""",""InformationSegment"":[],""IsHubSite"":false,""IsTeamsChannelConnected"":false,""IsTeamsConnected"":false,""LastContentModifiedDate"":""/Date(1669883125563)/"",""LimitedAccessFileType"":1,""LocaleId"":1033,""LockIssue"":null,""LockState"":""Unlock"",""LoopDefaultSharingLinkRole"":0,""LoopDefaultSharingLinkScope"":-1,""LoopOverrideSharingCapability"":false,""LoopSharingCapability"":2,""MediaTranscription"":0,""OverrideBlockUserInfoVisibility"":0,""OverrideSharingCapability"":false,""OverrideTenantAnonymousLinkExpirationPolicy"":false,""OverrideTenantExternalUserExpirationPolicy"":false,""Owner"":""efb52a3c-c813-4e58-855e-63e4bfb5a20e"",""PWAEnabled"":1,""ReadOnlyForUnmanagedDevices"":false,""RelatedGroupId"":""00000000-0000-0000-0000-000000000000"",""RequestFilesLinkEnabled"":true,""RequestFilesLinkExpirationInDays"":-1,""ResourceQuota"":300,""ResourceQuotaWarningLevel"":255,""ResourceUsageAverage"":0,""ResourceUsageCurrent"":0,""RestrictedAccessControl"":false,""RestrictedToGeo"":3,""SandboxedCodeActivationCapability"":2,""SensitivityLabel"":null,""SharingAllowedDomainList"":"""",""SharingBlockedDomainList"":"""",""SharingCapability"":2,""SharingDomainRestrictionMode"":0,""SharingLockDownCanBeCleared"":true,""SharingLockDownEnabled"":false,""ShowPeoplePickerSuggestionsForGuestUsers"":false,""SiteDefinedSharingCapability"":2,""SocialBarOnSitePagesDisabled"":false,""Status"":""Active"",""StorageQuota"":26214400,""StorageQuotaType"":null,""StorageQuotaWarningLevel"":25574400,""StorageUsageCurrent"":1,""TeamsChannelType"":0,""Template"":""SITEPAGEPUBLISHING#0"",""Title"":""Communication site"",""Url"":""https://tqhjy.sharepoint.com/"",""WebsCount"":1}","Get-SPOSite","Sharepoint 2.5","Shall","Requirement met","Users SHALL be prevented from running custom scripts on self-service created sites","True"
"true","Get-CsTeamsMeetingPolicy","Teams 2.9","Should","Requirement not met","Cloud video recording SHOULD be disabled in the global (org-wide default) meeting policy","False"
"""AlwaysEnabled""","Get-CsTeamsMeetingPolicy","Teams 2.10","Should","Requirement not met","Record an event SHOULD be set to Organizer can record","False"
"""EveryoneInCompany""","Get-CsTeamsMeetingPolicy","Teams 2.3","Should","Requirement met","Internal users SHOULD be admitted automatically","True"
,"","Teams 2.11","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","A DLP solution SHALL be enabled","False"
,"","Teams 2.11","Shall/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","The DLP solution SHALL protect Personally Identifiable Information (PII) and sensitive information, as defined by the agency. At a minimum, the sharing of credit card numbers, taxpayer Identification Numbers (TIN), and Social Security Numbers (SSN) via email SHALL be restricted","False"
,"","Teams 2.11","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Agencies SHOULD use either the native DLP solution offered by Microsoft or a DLP solution that offers comparable services","False"
,"","Teams 2.12","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Attachments included with Teams messages SHOULD be scanned for malware","False"
,"","Teams 2.12","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Users SHOULD be prevented from opening or downloading files detected as malware","False"
,"","Teams 2.13","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","Direct download links SHOULD be scanned for malware","False"
,"","Teams 2.13","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","URL comparison with a block-list SHOULD be enabled","False"
,"","Teams 2.13","Should/3rd Party","Custom implementation allowed. If you are using Defender to fulfill this requirement, run the Defender version of this script. Otherwise, use a 3rd party tool OR manually check","User click tracking SHOULD be enabled","False"
,"","Teams 2.8","Shall/3rd Party","Cannot be checked automatically. See Microsoft Teams Secure Configuration Baseline policy 2.8 for instructions on manual check","Agencies SHALL establish policy dictating the app review and approval process to be used by the agency","False"
"[""EveryoneInCompany"",false]","Get-CsTeamsMeetingPolicy","Teams 2.3","Should","Requirement met","Anonymous users, including dial-in users, SHOULD NOT be admitted automatically","True"
"[{""value"":[""Global""],""Count"":1},""MicrosoftCommunicationsOnline/NOAM-ED6-A5""]","Get-CsTeamsClientConfiguration","Teams 2.7","Shall","1 Requirement not met: Email integration is enabled across domain: Global","Teams email integration SHALL be disabled","False"
,"Get-CsTeamsAppPermissionPolicy","Teams 2.8","Should","Requirement met","Agencies SHOULD allow all apps published by Microsoft, but MAY block specific Microsoft apps as needed","True"
,"Get-CsTeamsMeetingPolicy","Teams 2.1","Should","Requirement met","External participants SHOULD NOT be enabled to request control of shared desktops or windows in the Global (Org-wide default) meeting policy or in custom meeting policies if any exist","True"
,"Get-CsTeamsMeetingPolicy","Teams 2.2","Shall","Requirement met","Anonymous users SHALL NOT be enabled to start meetings in the Global (Org-wide default) meeting policy or in custom meeting policies if any exist","True"
,"Get-CsTeamsMeetingPolicy","Teams 2.4","Should","Requirement met","Anonymous users SHOULD be enabled to join meetings","True"
,"Get-CsTeamsMeetingPolicy","Teams 2.9","Should","Requirement met","For all meeting polices that allow cloud recording, recordings SHOULD be stored inside the country of that agencyGÇÖs tenant","True"
,"Get-CsTenantFederationConfiguration","Teams 2.4","Shall","Requirement met","External access SHALL only be enabled on a per-domain basis","True"
,"Get-CsTenantFederationConfiguration","Teams 2.5","Shall","Requirement met","Unmanaged users SHALL NOT be enabled to initiate contact with internal users","True"
,"Get-CsTenantFederationConfiguration","Teams 2.5","Should","Requirement met","Internal users SHOULD NOT be enabled to initiate contact with unmanaged users","True"
,"Get-CsTenantFederationConfiguration","Teams 2.6","Shall","Requirement met","Contact with Skype users SHALL be blocked","True"
"""Global""","Get-CsTeamsAppPermissionPolicy","Teams 2.8","Should","1 meeting policy(ies) found that allow custom apps by default: Global","Agencies SHOULD NOT allow installation of all custom apps, but MAY allow specific apps as needed","False"
"""Global""","Get-CsTeamsAppPermissionPolicy","Teams 2.8","Should","1 meeting policy(ies) found that allow third-party apps by default: Global","Agencies SHOULD NOT allow installation of all third-party apps, but MAY allow specific apps as needed","False"
